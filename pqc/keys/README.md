# SATL 3.0 PQC Keys

## Metadata

- **Algorithm**: dilithium3
- **Mode**: mock
- **Generated**: Data corrente: 03/11/2025 
Immettere la nuova data: (gg-mm-aa)
- **Public Key**: pqc/keys/pk.bin
- **Secret Key**: pqc/keys/sk.bin

## Key Sizes

- Public Key: 1952 bytes
- Secret Key: 4000 bytes

## Fingerprints (SHA-256)

- Public Key: `15b2a90d28ec7b4af1fe7cbefb14cab29e802875cc89bd38f4285ec3636e1ddc`
- Secret Key: `9355cc47f27cb26b5d1dcaa742a6dc0e94e7b4f30432c22aff33b1ac50a12ee3`

## Security

⚠️ **CRITICAL SECURITY NOTES**:

1. **Secret Key Protection**:
   - Store `sk.bin` in secure location (HSM, encrypted vault)
   - Never commit to version control
   - Restrict file permissions: `chmod 600 sk.bin`
   - Delete from disk after import to HSM

2. **Public Key Distribution**:
   - `pk.bin` can be distributed publicly
   - Include in SPO rotation pack configuration
   - Verify fingerprint after transfer

3. **Mode Indicator**:
   - **MOCK**: Test-only, deterministic signatures (INSECURE)
   - **REAL**: liboqs Dilithium3 (production-ready)

## Usage

### Sign SPO Rotation Pack

```python
from pqc.dilithium3_provider import Dilithium3Provider

# Load secret key
with open("pqc/keys/sk.bin", "rb") as f:
    secret_key = f.read()

# Initialize provider
provider = Dilithium3Provider(mode="real")

# Sign payload
payload = b"rotation pack data"
signature = provider.sign(payload, secret_key)
```

### Verify Signature

```python
from pqc.dilithium3_provider import Dilithium3Provider

# Load public key
with open("pqc/keys/pk.bin", "rb") as f:
    public_key = f.read()

# Initialize provider
provider = Dilithium3Provider(mode="real")

# Verify signature
is_valid = provider.verify(payload, signature, public_key)
```

## Key Rotation

Recommended rotation schedule:
- **Development**: Every 7 days
- **Production**: Every 30 days
- **Emergency**: Immediately if compromise suspected

## Backup

1. Create encrypted backup:
   ```bash
   # Linux/Mac
   tar czf keys-backup.tar.gz pqc/keys/
   openssl enc -aes-256-cbc -salt -in keys-backup.tar.gz -out keys-backup.tar.gz.enc
   rm keys-backup.tar.gz
   ```

2. Store backup in multiple secure locations

3. Test restore procedure regularly

## Revocation

If keys are compromised:
1. Generate new keypair immediately
2. Update SPO configuration with new public key
3. Sign revocation message with old key (if still controlled)
4. Distribute new public key via secure channel
5. Wipe old secret key securely (shred/srm)

---

**Generated by**: SATL 3.0 PQC Key Generator
**Provider Mode**: mock
